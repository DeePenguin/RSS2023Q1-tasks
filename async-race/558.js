"use strict";(self.webpackChunkasync_race=self.webpackChunkasync_race||[]).push([[558],{58:(e,t,n)=>{n.r(t),n.d(t,{Winners:()=>g});var r,s,o=n(803),a=n(85),i=n(613),c=n(785),u=n(688),l=n(698);!function(e){e.Id="id",e.Wins="wins",e.Time="time"}(r||(r={})),function(e){e.Asc="ASC",e.Desc="DESC"}(s||(s={}));var f,p=n(71),h=n(508),d=function(){return d=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},d.apply(this,arguments)},w=function(){function e(e){this.itemsPerPage=e,this.garageApi=p.q,this.winnersApi=h.Q,this.carsCount=new l.y(0)}return e.prototype.getWinners=function(e,t,n){var r,s,o,a,i,c,u,l;return i=this,c=void 0,l=function(){var i,c,u,l,f,p,h,w,y,_;return function(e,t){var n,r,s,o,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,i[0]&&(a=0)),a;)try{if(n=1,r&&(s=2&i[0]?r.return:i[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,i[1])).done)return s;switch(r=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((s=(s=a.trys).length>0&&s[s.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){a.label=i[1];break}if(6===i[0]&&a.label<s[1]){a.label=s[1],s=i;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(i);break}s[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}(this,(function(b){switch(b.label){case 0:return[4,this.winnersApi.getWinners(e,this.itemsPerPage,t,n)];case 1:i=b.sent(),this.carsCount.setValue(i.totalCount),c=[],b.label=2;case 2:b.trys.push([2,8,9,14]),u=!0,l=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,s){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,s,(t=e[n](t)).done,t.value)}))}}}(i.winners),b.label=3;case 3:return[4,l.next()];case 4:return f=b.sent(),(r=f.done)?[3,7]:(a=f.value,u=!1,p=a,[4,this.garageApi.getCar(p.id)]);case 5:h=b.sent(),w=h.color,y=h.name,c.push(d(d({},p),{color:w,name:y})),b.label=6;case 6:return u=!0,[3,3];case 7:return[3,14];case 8:return _=b.sent(),s={error:_},[3,14];case 9:return b.trys.push([9,,12,13]),u||r||!(o=l.return)?[3,11]:[4,o.call(l)];case 10:b.sent(),b.label=11;case 11:return[3,13];case 12:if(s)throw s.error;return[7];case 13:return[7];case 14:return[2,c]}}))},new((u=void 0)||(u=Promise))((function(e,t){function n(e){try{s(l.next(e))}catch(e){t(e)}}function r(e){try{s(l.throw(e))}catch(e){t(e)}}function s(t){var s;t.done?e(t.value):(s=t.value,s instanceof u?s:new u((function(e){e(s)}))).then(n,r)}s((l=l.apply(i,c||[])).next())}))},e}(),y=(f=function(e,t){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},f(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),_=function(e){function t(t,n,r,s,o){var a=e.call(this,{tag:"table",className:"winners__table"})||this;a.page=0,a.contentChanger=new u.Q((function(e){return a.showWinners(e)})),a.pageChanger=new u.Q((function(e){a.page=10*(e-1)})),a.sortableHeaders=[],a.body=new c.H({tag:"tbody",className:"winners__tbody"});var i=a.createHeader(r,s,o);return a.append(i,a.body),t.subscribe(a.contentChanger),n.subscribe(a.pageChanger),a}return y(t,e),t.prototype.createHeader=function(e,t,n){var s=this,o=Object.values(r),a=new c.H({tag:"thead",className:"winners__thead"}),i=new c.H({parent:a,tag:"tr",className:"winners__tr"});return["â„–","car","name","wins","time"].forEach((function(r){var a=new c.H({parent:i,tag:"th",className:"winners__th",content:r});o.includes(r)&&(s.sortableHeaders.push(a),a.addClass("winners__th--sortable"),a.addListener("click",(function(){s.sortableHeaders.forEach((function(e){return e.removeClass("winners__th--active")})),a.addClass("winners__th--active"),n(r)}))),r===e&&(a.addClass("winners__th--active"),a.addClass(t))})),a},t.prototype.showWinners=function(e){var t=this;this.body.getNode().innerHTML="",e.forEach((function(e,n){var r=e.name,s=e.color,o=e.wins,a=e.time,i='\n      <td class="winners__td">'.concat(t.page+n+1,'</td>\n      <td class="winners__td winners__td--center"><div class ="car__item" style="--car-color: ').concat(s,'"</td>\n      <td class="winners__td winners__td--center">').concat(r,'</td>\n      <td class="winners__td">').concat(o,'</td>\n      <td class="winners__td">').concat(a,"</td>\n      "),u=new c.H({tag:"tr",className:"winners__tr",content:i});t.body.append(u)}))},t}(c.H),b=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),g=function(e){function t(t){var n,c,f=this;return(f=e.call(this,{tag:"section",className:"winners"})||this).store=t,f.itemsPerPage=o.V.winners,f.winnersService=new w(f.itemsPerPage),f.pageChanger=new u.Q((function(){return f.renderPage()})),f.winners=new l.y([]),f.store.sortBy=null!==(n=f.store.sortBy)&&void 0!==n?n:r.Wins,f.store.sortOrder=null!==(c=f.store.sortOrder)&&void 0!==c?c:s.Asc,f.header=new a.m("Winners",f.winnersService.carsCount),f.pagination=new i.t(f.winnersService.carsCount,f.itemsPerPage,f.store.currentPage),f.table=new _(f.winners,f.store.currentPage,f.store.sortBy,f.store.sortOrder,(function(e){return f.sort(e)})),f.append(f.header,f.pagination,f.table),f.renderPage(),f.store.currentPage.subscribe(f.pageChanger),f}return b(t,e),t.prototype.renderPage=function(){var e=this;this.winnersService.getWinners(this.store.currentPage.getValue(),this.store.sortBy,this.store.sortOrder).then((function(t){return e.winners.setValue(t)})).catch((function(e){console.error(e)}))},t.prototype.sort=function(e){e===this.store.sortBy?this.store.sortOrder=this.store.sortOrder===s.Asc?s.Desc:s.Asc:(this.store.sortBy=e,this.store.sortOrder=s.Asc),this.renderPage()},t}(c.H)}}]);